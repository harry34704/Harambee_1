{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <h2 class="mb-4">Application Management</h2>
    
    <div class="row">
        <div class="col-md-12">
            {% for application in applications %}
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h5>{{ application.name }}</h5>
                            <p class="mb-1"><i class="fas fa-envelope me-2"></i>{{ application.user.email }}</p>
                            <p class="mb-1"><i class="fas fa-phone me-2"></i>{{ application.phone }}</p>
                            <p class="mb-1"><i class="fas fa-user me-2"></i>Guardian: {{ application.guardian_name }}</p>
                            <p class="mb-1"><i class="fas fa-phone me-2"></i>Guardian Phone: {{ application.guardian_phone }}</p>
                        </div>
                        <div class="col-md-4">
                            <h5>Documents</h5>
                            <div class="list-group">
                                {% if application.id_document %}
                                <a href="{{ url_for('view_document', student_id=application.id, doc_type='id') }}" 
                                   class="list-group-item list-group-item-action" target="_blank">
                                    <i class="fas fa-id-card me-2"></i>ID Document
                                </a>
                                {% endif %}
                                
                                {% if application.parent_id %}
                                <a href="{{ url_for('view_document', student_id=application.id, doc_type='parent_id') }}" 
                                   class="list-group-item list-group-item-action" target="_blank">
                                    <i class="fas fa-id-card me-2"></i>Guardian ID
                                </a>
                                {% endif %}
                                
                                {% if application.payslip %}
                                <a href="{{ url_for('view_document', student_id=application.id, doc_type='payslip') }}" 
                                   class="list-group-item list-group-item-action" target="_blank">
                                    <i class="fas fa-file-invoice-dollar me-2"></i>Payslip
                                </a>
                                {% endif %}
                                
                                {% if application.bank_statement %}
                                <a href="{{ url_for('view_document', student_id=application.id, doc_type='bank_statement') }}" 
                                   class="list-group-item list-group-item-action" target="_blank">
                                    <i class="fas fa-file-invoice me-2"></i>Bank Statement
                                </a>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h5>Actions</h5>
                            <form method="POST" action="{{ url_for('process_application', student_id=application.id) }}" class="mb-2">
                                <input type="hidden" name="action" value="approve">
                                <button type="submit" class="btn btn-success w-100 mb-2">
                                    <i class="fas fa-check me-2"></i>Approve
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('process_application', student_id=application.id) }}" class="mb-2">
                                <input type="hidden" name="action" value="hold">
                                <button type="submit" class="btn btn-warning w-100 mb-2">
                                    <i class="fas fa-pause me-2"></i>Put On Hold
                                </button>
                            </form>
                            
                            <form method="POST" action="{{ url_for('process_application', student_id=application.id) }}">
                                <input type="hidden" name="action" value="reject">
                                <button type="submit" class="btn btn-danger w-100">
                                    <i class="fas fa-times me-2"></i>Reject
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                No pending applications at the moment.
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
